arrange(Sample_Name)
# ================================  plot =======================================
# colors <- c("#2A788EFF", "#7AD151FF")
c_mol <- ggplot(data = combine_filter, aes(x = delGcoxPerCmol, y = lamO2, color = "#2A788EFF")) +
geom_point(size = .75)+
geom_smooth(method=lm, size = .75, color = 'black')+
labs(x = 'Gibbs (C-mol) ', y = 'Lambda')+
# geom_text(aes(Inf, -Inf, label = paste('R^2 ==',round(sample_stats$C_mol_lambda_R2, 2))),col = "black",hjust = 1.6, position = position_dodge(width = 1),vjust = -19, size = 3, parse = T)+
annotate('text', x=max(combine_filter$delGcoxPerCmol)*.6,y=max(combine_filter$lamO2)*.775,label = paste('R^2 ==',round(sample_stats$C_mol_lambda_R2, 2)), parse = T, size = 4, family = 'serif')+
annotate('text', x=max(combine_filter$delGcoxPerCmol)*.6,y=max(combine_filter$lamO2)*.85,label = sample_stats$C_mol_lambda_eq,  size = 4, family = 'serif')+
scale_color_manual(values = "#2A788EFF")
c_mol
comp_mol<- ggplot(data = all_sample_peaks, aes(x = delGd, y = lamO2, color = "#2A788EFF")) +
geom_point(size = .75)+
geom_smooth(method=lm, size = .75, color = 'black')+
labs(x = 'Gibbs (Comp-mol) ', y = 'Lambda')+
annotate('text', x = max(combine_filter$delGd)*.6, y = max(combine_filter$lamO2)*.775, label = paste('R^2 ==',round(sample_stats$Comp_mol_lambda_R2, 2)), parse = T, size = 4, family = 'serif')+
annotate('text', x = max(combine_filter$delGd)*.6, y = max(combine_filter$lamO2)*.85, label = sample_stats$Comp_mol_lambda_eq, size = 4, family = 'serif')+
scale_color_manual(values = "#2A788EFF")
comp_mol
combine_plots <- ggarrange(
c_mol,
comp_mol,
ncol = 2,
nrow = 1,
widths = c(4),
heights = c(4, 4)
)
combine_plots <-
annotate_figure(combine_plots, top = text_grob(
i,
size = 14,
family = 'serif',
face = 'bold'
))
combine_plots_out <- paste0(here::here(),'/ECA_Within_Sample_Peaks_Plots/', i, '.pdf' )
ggsave(
combine_plots_out,
combine_plots,
device = 'pdf',
width = 10,
height = 5,
units = 'in',
dpi = 300
)
}
quantile(combine_filter$delGd, probs = 0.9, na.rm = T)
c_mol <- ggplot(data = combine_filter, aes(x = delGcoxPerCmol, y = lamO2, color = "#2A788EFF")) +
geom_point(size = .75)+
geom_smooth(method=lm, size = .75, color = 'black')+
labs(x = 'Gibbs (C-mol) ', y = 'Lambda')+
# geom_text(aes(Inf, -Inf, label = paste('R^2 ==',round(sample_stats$C_mol_lambda_R2, 2))),col = "black",hjust = 1.6, position = position_dodge(width = 1),vjust = -19, size = 3, parse = T)+
annotate('text', x=quantile(combine_filter$delGcoxPerCmol, probs = 0.9, na.rm = T), y=quantile(combine_filter$lamO2, probs = 0.9, na.rm = T),label = paste('R^2 ==',round(sample_stats$C_mol_lambda_R2, 2)), parse = T, size = 4, family = 'serif')+
annotate('text', x=quantile(combine_filter$delGcoxPerCmol, probs = 0.9, na.rm = T), y=quantile(combine_filter$lamO2, probs = 0.9, na.rm = T),label = sample_stats$C_mol_lambda_eq,  size = 4, family = 'serif')+
scale_color_manual(values = "#2A788EFF")
c_mol
comp_mol<- ggplot(data = all_sample_peaks, aes(x = delGd, y = lamO2, color = "#2A788EFF")) +
geom_point(size = .75)+
geom_smooth(method=lm, size = .75, color = 'black')+
labs(x = 'Gibbs (Comp-mol) ', y = 'Lambda')+
annotate('text', x = quantile(combine_filter$delGd, probs = 0.9, na.rm = T), y = quantile(combine_filter$lamO2, probs = 0.9, na.rm = T), label = paste('R^2 ==',round(sample_stats$Comp_mol_lambda_R2, 2)), parse = T, size = 4, family = 'serif')+
annotate('text', x = quantile(combine_filter$delGd, probs = 0.9, na.rm = T), y = quantile(combine_filter$lamO2, probs = 0.9, na.rm = T), label = sample_stats$Comp_mol_lambda_eq, size = 4, family = 'serif')+
scale_color_manual(values = "#2A788EFF")
comp_mol
summary(combine_filter$lamO2)
c_mol <- ggplot(data = combine_filter, aes(x = delGcoxPerCmol, y = lamO2, color = "#2A788EFF")) +
geom_point(size = .75)+
geom_smooth(method=lm, size = .75, color = 'black')+
labs(x = 'Gibbs (C-mol) ', y = 'Lambda')+
# geom_text(aes(Inf, -Inf, label = paste('R^2 ==',round(sample_stats$C_mol_lambda_R2, 2))),col = "black",hjust = 1.6, position = position_dodge(width = 1),vjust = -19, size = 3, parse = T)+
annotate('text', x=quantile(combine_filter$delGcoxPerCmol, probs = 0.95, na.rm = T), y=quantile(combine_filter$lamO2, probs = 0.95, na.rm = T),label = paste('R^2 ==',round(sample_stats$C_mol_lambda_R2, 2)), parse = T, size = 4, family = 'serif')+
annotate('text', x=quantile(combine_filter$delGcoxPerCmol, probs = 0.95, na.rm = T), y=quantile(combine_filter$lamO2, probs = 0.95, na.rm = T),label = sample_stats$C_mol_lambda_eq,  size = 4, family = 'serif')+
scale_color_manual(values = "#2A788EFF")
c_mol
comp_mol<- ggplot(data = all_sample_peaks, aes(x = delGd, y = lamO2, color = "#2A788EFF")) +
geom_point(size = .75)+
geom_smooth(method=lm, size = .75, color = 'black')+
labs(x = 'Gibbs (Comp-mol) ', y = 'Lambda')+
annotate('text', x = quantile(combine_filter$delGd, probs = 0.95, na.rm = T), y = quantile(combine_filter$lamO2, probs = 0.95, na.rm = T), label = paste('R^2 ==',round(sample_stats$Comp_mol_lambda_R2, 2)), parse = T, size = 4, family = 'serif')+
annotate('text', x = quantile(combine_filter$delGd, probs = 0.95, na.rm = T), y = quantile(combine_filter$lamO2, probs = 0.95, na.rm = T), label = sample_stats$Comp_mol_lambda_eq, size = 4, family = 'serif')+
scale_color_manual(values = "#2A788EFF")
comp_mol
install.packages("cowplot")
install.packages("cowplot")
install.packages("cowplot")
library(cowplot)
c_mol <- ggplot(data = combine_filter, aes(x = delGcoxPerCmol, y = lamO2, color = "#2A788EFF")) +
geom_point(size = .75)+
geom_smooth(method=lm, size = .75, color = 'black')+
labs(x = 'Gibbs (C-mol) ', y = 'Lambda')+
# geom_text(aes(Inf, -Inf, label = paste('R^2 ==',round(sample_stats$C_mol_lambda_R2, 2))),col = "black",hjust = 1.6, position = position_dodge(width = 1),vjust = -19, size = 3, parse = T)+
# annotate('text', x=quantile(combine_filter$delGcoxPerCmol, probs = 0.95, na.rm = T), y=quantile(combine_filter$lamO2, probs = 0.95, na.rm = T),label = paste('R^2 ==',round(sample_stats$C_mol_lambda_R2, 2)), parse = T, size = 4, family = 'serif')+
# annotate('text', x=quantile(combine_filter$delGcoxPerCmol, probs = 0.95, na.rm = T), y=quantile(combine_filter$lamO2, probs = 0.95, na.rm = T),label = sample_stats$C_mol_lambda_eq,  size = 4, family = 'serif')+
scale_color_manual(values = "#2A788EFF")
c_mol
theme_set(
theme(
text = element_text(family = 'serif'),
axis.title = element_text(size = 16, face = 'bold'),
axis.text = element_text(size = 14, face = 'bold'),
line = element_line(size = 0.05),
axis.line = element_line(size = 0.5),
panel.background = element_rect(color = 'white'),
panel.border = element_rect(
colour = 'black',
fill = NA,
size = 0.5
),
plot.title = element_text(size = 25, face = 'bold'),
legend.position = 'none'
)
)
library(tidyverse)
library(glue)
library(viridisLite)
library(ggpubr)
library(cowplot)
theme_set(
theme(
text = element_text(family = 'serif'),
axis.title = element_text(size = 16, face = 'bold'),
axis.text = element_text(size = 14, face = 'bold'),
line = element_line(size = 0.05),
axis.line = element_line(size = 0.5),
panel.background = element_rect(color = 'white'),
panel.border = element_rect(
colour = 'black',
fill = NA,
size = 0.5
),
plot.title = element_text(size = 25, face = 'bold'),
legend.position = 'none'
)
)
c_mol <- ggplot(data = combine_filter, aes(x = delGcoxPerCmol, y = lamO2, color = "#2A788EFF")) +
geom_point(size = .75)+
geom_smooth(method=lm, size = .75, color = 'black')+
labs(x = 'Gibbs (C-mol) ', y = 'Lambda')+
# geom_text(aes(Inf, -Inf, label = paste('R^2 ==',round(sample_stats$C_mol_lambda_R2, 2))),col = "black",hjust = 1.6, position = position_dodge(width = 1),vjust = -19, size = 3, parse = T)+
# annotate('text', x=quantile(combine_filter$delGcoxPerCmol, probs = 0.95, na.rm = T), y=quantile(combine_filter$lamO2, probs = 0.95, na.rm = T),label = paste('R^2 ==',round(sample_stats$C_mol_lambda_R2, 2)), parse = T, size = 4, family = 'serif')+
# annotate('text', x=quantile(combine_filter$delGcoxPerCmol, probs = 0.95, na.rm = T), y=quantile(combine_filter$lamO2, probs = 0.95, na.rm = T),label = sample_stats$C_mol_lambda_eq,  size = 4, family = 'serif')+
scale_color_manual(values = "#2A788EFF")
c_mol
c_mol_test <- ggdraw(c_mol) +
draw_label('test', x =.5, y = .5)
c_mol_test
c_mol_test <- ggdraw(c_mol) +
draw_label('test', x =.1, y = .7)
c_mol_test
c_mol_test <- ggdraw(c_mol) +
draw_label('test', x =.3, y = .7)
c_mol_test
c_mol_test <- ggdraw(c_mol) +
draw_label('test', x =.2, y = .8)
c_mol_test
c_mol_test <- ggdraw(c_mol) +
draw_label('test', x =.2, y = .9)
c_mol_test
c_mol <- ggplot(data = combine_filter, aes(x = delGcoxPerCmol, y = lamO2, color = "#2A788EFF")) +
geom_point(size = .75)+
geom_smooth(method=lm, size = .75, color = 'black')+
labs(x = 'Gibbs (C-mol) ', y = 'Lambda')+
# geom_text(aes(Inf, -Inf, label = paste('R^2 ==',round(sample_stats$C_mol_lambda_R2, 2))),col = "black",hjust = 1.6, position = position_dodge(width = 1),vjust = -19, size = 3, parse = T)+
# annotate('text', x=quantile(combine_filter$delGcoxPerCmol, probs = 0.95, na.rm = T), y=quantile(combine_filter$lamO2, probs = 0.95, na.rm = T),label = paste('R^2 ==',round(sample_stats$C_mol_lambda_R2, 2)), parse = T, size = 4, family = 'serif')+
# annotate('text', x=quantile(combine_filter$delGcoxPerCmol, probs = 0.95, na.rm = T), y=quantile(combine_filter$lamO2, probs = 0.95, na.rm = T),label = sample_stats$C_mol_lambda_eq,  size = 4, family = 'serif')+
scale_color_manual(values = "#2A788EFF")
c_mol
c_mol <- ggdraw(c_mol) +
draw_label(paste('R^2 ==',round(sample_stats$C_mol_lambda_R2, 2)), parse = T, x = 0.2, y = 0.9, family = 'serif')
c_mol <- ggdraw(c_mol) +
draw_label(paste('R^2 ==',round(sample_stats$C_mol_lambda_R2, 2)), x = 0.2, y = 0.9)
c_mol
c_mol <- ggplot(data = combine_filter, aes(x = delGcoxPerCmol, y = lamO2, color = "#2A788EFF")) +
geom_point(size = .75)+
geom_smooth(method=lm, size = .75, color = 'black')+
labs(x = 'Gibbs (C-mol) ', y = 'Lambda')+
# geom_text(aes(Inf, -Inf, label = paste('R^2 ==',round(sample_stats$C_mol_lambda_R2, 2))),col = "black",hjust = 1.6, position = position_dodge(width = 1),vjust = -19, size = 3, parse = T)+
# annotate('text', x=quantile(combine_filter$delGcoxPerCmol, probs = 0.95, na.rm = T), y=quantile(combine_filter$lamO2, probs = 0.95, na.rm = T),label = paste('R^2 ==',round(sample_stats$C_mol_lambda_R2, 2)), parse = T, size = 4, family = 'serif')+
# annotate('text', x=quantile(combine_filter$delGcoxPerCmol, probs = 0.95, na.rm = T), y=quantile(combine_filter$lamO2, probs = 0.95, na.rm = T),label = sample_stats$C_mol_lambda_eq,  size = 4, family = 'serif')+
scale_color_manual(values = "#2A788EFF")
c_mol
c_mol <- ggdraw(c_mol) +
draw_label(bquote(R^2 == . (round(sample_stats$C_mol_lambda_R2, 2))), x = 0.2, y = 0.9)
c_mol
c_mol <- ggplot(data = combine_filter, aes(x = delGcoxPerCmol, y = lamO2, color = "#2A788EFF")) +
geom_point(size = .75)+
geom_smooth(method=lm, size = .75, color = 'black')+
labs(x = 'Gibbs (C-mol) ', y = 'Lambda')+
# geom_text(aes(Inf, -Inf, label = paste('R^2 ==',round(sample_stats$C_mol_lambda_R2, 2))),col = "black",hjust = 1.6, position = position_dodge(width = 1),vjust = -19, size = 3, parse = T)+
# annotate('text', x=quantile(combine_filter$delGcoxPerCmol, probs = 0.95, na.rm = T), y=quantile(combine_filter$lamO2, probs = 0.95, na.rm = T),label = paste('R^2 ==',round(sample_stats$C_mol_lambda_R2, 2)), parse = T, size = 4, family = 'serif')+
# annotate('text', x=quantile(combine_filter$delGcoxPerCmol, probs = 0.95, na.rm = T), y=quantile(combine_filter$lamO2, probs = 0.95, na.rm = T),label = sample_stats$C_mol_lambda_eq,  size = 4, family = 'serif')+
scale_color_manual(values = "#2A788EFF")
c_mol
c_mol <- ggdraw(c_mol) +
draw_label(bquote(R^2 == . (round(sample_stats$C_mol_lambda_R2, 2))), x = 0.2, y = 0.9, fontfamily = 'serif')
c_mol
c_mol <- ggplot(data = combine_filter, aes(x = delGcoxPerCmol, y = lamO2, color = "#2A788EFF")) +
geom_point(size = .75)+
geom_smooth(method=lm, size = .75, color = 'black')+
labs(x = 'Gibbs (C-mol) ', y = 'Lambda')+
# geom_text(aes(Inf, -Inf, label = paste('R^2 ==',round(sample_stats$C_mol_lambda_R2, 2))),col = "black",hjust = 1.6, position = position_dodge(width = 1),vjust = -19, size = 3, parse = T)+
# annotate('text', x=quantile(combine_filter$delGcoxPerCmol, probs = 0.95, na.rm = T), y=quantile(combine_filter$lamO2, probs = 0.95, na.rm = T),label = paste('R^2 ==',round(sample_stats$C_mol_lambda_R2, 2)), parse = T, size = 4, family = 'serif')+
# annotate('text', x=quantile(combine_filter$delGcoxPerCmol, probs = 0.95, na.rm = T), y=quantile(combine_filter$lamO2, probs = 0.95, na.rm = T),label = sample_stats$C_mol_lambda_eq,  size = 4, family = 'serif')+
scale_color_manual(values = "#2A788EFF")
c_mol <- ggdraw(c_mol) +
draw_label(bquote(R^2 == . (round(sample_stats$C_mol_lambda_R2, 2))), x = 0.2, y = 0.9, fontfamily = 'serif')+
draw_label(sample_stats$C_mol_lambda_eq, x = 0.2, y = 0.85, fontfamily = 'serif')
c_mol
c_mol <- ggplot(data = combine_filter, aes(x = delGcoxPerCmol, y = lamO2, color = "#2A788EFF")) +
geom_point(size = .75)+
geom_smooth(method=lm, size = .75, color = 'black')+
labs(x = 'Gibbs (C-mol) ', y = 'Lambda')+
# geom_text(aes(Inf, -Inf, label = paste('R^2 ==',round(sample_stats$C_mol_lambda_R2, 2))),col = "black",hjust = 1.6, position = position_dodge(width = 1),vjust = -19, size = 3, parse = T)+
# annotate('text', x=quantile(combine_filter$delGcoxPerCmol, probs = 0.95, na.rm = T), y=quantile(combine_filter$lamO2, probs = 0.95, na.rm = T),label = paste('R^2 ==',round(sample_stats$C_mol_lambda_R2, 2)), parse = T, size = 4, family = 'serif')+
# annotate('text', x=quantile(combine_filter$delGcoxPerCmol, probs = 0.95, na.rm = T), y=quantile(combine_filter$lamO2, probs = 0.95, na.rm = T),label = sample_stats$C_mol_lambda_eq,  size = 4, family = 'serif')+
scale_color_manual(values = "#2A788EFF")
c_mol
c_mol <- ggdraw(c_mol) +
draw_label(bquote(R^2 == . (round(sample_stats$C_mol_lambda_R2, 2))), x = 0.3, y = 0.9, fontfamily = 'serif')+
draw_label(sample_stats$C_mol_lambda_eq, x = 0.3, y = 0.85, fontfamily = 'serif')
c_mol
comp_mol<- ggplot(data = all_sample_peaks, aes(x = delGd, y = lamO2, color = "#2A788EFF")) +
geom_point(size = .75)+
geom_smooth(method=lm, size = .75, color = 'black')+
labs(x = 'Gibbs (Comp-mol) ', y = 'Lambda')+
# annotate('text', x = quantile(combine_filter$delGd, probs = 0.95, na.rm = T), y = quantile(combine_filter$lamO2, probs = 0.95, na.rm = T), label = paste('R^2 ==',round(sample_stats$Comp_mol_lambda_R2, 2)), parse = T, size = 4, family = 'serif')+
# annotate('text', x = quantile(combine_filter$delGd, probs = 0.95, na.rm = T), y = quantile(combine_filter$lamO2, probs = 0.95, na.rm = T), label = sample_stats$Comp_mol_lambda_eq, size = 4, family = 'serif')+
scale_color_manual(values = "#2A788EFF")
comp_mol <- ggdraw(comp_mol) +
draw_label(bquote(R^2 == . (round(sample_stats$Comp_mol_lambda_R2, 2))), x = 0.3, y = 0.9, fontfamily = 'serif')+
draw_label(sample_stats$Comp_mol_lambda_eq, x = 0.3, y = 0.85, fontfamily = 'serif')
comp_mol
combine_plots <- ggarrange(
c_mol,
comp_mol,
ncol = 2,
nrow = 1,
widths = c(4),
heights = c(4, 4)
)
combine_plots <-
annotate_figure(combine_plots, top = text_grob(
i,
size = 14,
family = 'serif',
face = 'bold'
))
combine_plots_out <- paste0(here::here(),'/ECA_Within_Sample_Peaks_Plots/', i, '.pdf' )
ggsave(
combine_plots_out,
combine_plots,
device = 'pdf',
width = 10,
height = 5,
units = 'in',
dpi = 300
)
for (i in random_samples) {
dat_temp <- dat %>%
select('Mass', i)%>%
filter(get(i) == 1)
mol_temp <- mol %>%
filter(!is.na(lamO2))
combine <- dat_temp %>%
left_join(mol_temp)%>%
filter(!is.na(delGd) & !is.na(lamO2) & !is.na(delGcoxPerCmol))
combine_filter <- combine %>%
select("delGd","lamO2","delGcoxPerCmol") %>%
add_column(Sample_Name = i, .before = 'delGd')
all_sample_peaks <- all_sample_peaks %>%
add_row(combine_filter)
Comp_mol_lm <- summary(lm(combine$lamO2 ~ combine$delGd))
Comp_mol_R2 <- Comp_mol_lm$r.squared # R2 for Gibbs per Comp mol (pH 7)
Comp_mol_slope <- Comp_mol_lm$coefficients[2,1] # slope for Gibbs per Comp mol (pH 7)
Comp_mol_eq <- glue('y = {round(Comp_mol_lm$coefficients[2],3)}x + {round(Comp_mol_lm$coefficients[1], 3)}')
C_mol_lm <- summary(lm(combine$lamO2 ~ combine$delGcoxPerCmol))
C_mol_R2 <- C_mol_lm$r.squared # R2 for Gibbs per C mol (pH 7)
C_mol_slope <- C_mol_lm$coefficients[2,1] # slope for Gibbs per C mol (pH 7)
C_mol_eq <- glue('y = {round(C_mol_lm$coefficients[2],3)}x + {round(C_mol_lm$coefficients[1], 3)}')
sample_stats <- tibble(
Sample_Name = i,
Number_of_Formulas = nrow(combine),
Comp_mol_lambda_R2 = Comp_mol_R2,
C_mol_lambda_R2 = C_mol_R2,
Comp_mol_lambda_slope = Comp_mol_slope,
C_mol_lambda_slope = C_mol_slope,
Comp_mol_lambda_eq = Comp_mol_eq,
C_mol_lambda_eq = C_mol_eq,
Comp_mol_C_mol_Rsq_Ratio = (Comp_mol_R2/C_mol_R2),
Comp_mol_C_mol_Slope_Ratio = (Comp_mol_slope/C_mol_slope)
)
sample_stats_combine <- sample_stats_combine %>%
add_row(sample_stats)%>%
arrange(Sample_Name)
# ================================  plot =======================================
# colors <- c("#2A788EFF", "#7AD151FF")
c_mol <- ggplot(data = combine_filter, aes(x = delGcoxPerCmol, y = lamO2, color = "#2A788EFF")) +
geom_point(size = .75)+
geom_smooth(method=lm, size = .75, color = 'black')+
labs(x = 'Gibbs (C-mol) ', y = 'Lambda')+
scale_color_manual(values = "#2A788EFF")
c_mol <- ggdraw(c_mol) +
draw_label(bquote(R^2 == . (round(sample_stats$C_mol_lambda_R2, 2))), x = 0.3, y = 0.9, fontfamily = 'serif')+
draw_label(sample_stats$C_mol_lambda_eq, x = 0.3, y = 0.85, fontfamily = 'serif')
c_mol
comp_mol<- ggplot(data = all_sample_peaks, aes(x = delGd, y = lamO2, color = "#2A788EFF")) +
geom_point(size = .75)+
geom_smooth(method=lm, size = .75, color = 'black')+
labs(x = 'Gibbs (Comp-mol) ', y = 'Lambda')+
# annotate('text', x = quantile(combine_filter$delGd, probs = 0.95, na.rm = T), y = quantile(combine_filter$lamO2, probs = 0.95, na.rm = T), label = paste('R^2 ==',round(sample_stats$Comp_mol_lambda_R2, 2)), parse = T, size = 4, family = 'serif')+
# annotate('text', x = quantile(combine_filter$delGd, probs = 0.95, na.rm = T), y = quantile(combine_filter$lamO2, probs = 0.95, na.rm = T), label = sample_stats$Comp_mol_lambda_eq, size = 4, family = 'serif')+
scale_color_manual(values = "#2A788EFF")
comp_mol <- ggdraw(comp_mol) +
draw_label(bquote(R^2 == . (round(sample_stats$Comp_mol_lambda_R2, 2))), x = 0.3, y = 0.9, fontfamily = 'serif')+
draw_label(sample_stats$Comp_mol_lambda_eq, x = 0.3, y = 0.85, fontfamily = 'serif')
comp_mol
combine_plots <- ggarrange(
c_mol,
comp_mol,
ncol = 2,
nrow = 1,
widths = c(4),
heights = c(4, 4)
)
combine_plots <-
annotate_figure(combine_plots, top = text_grob(
i,
size = 14,
family = 'serif',
face = 'bold'
))
combine_plots_out <- paste0(here::here(),'/ECA_Within_Sample_Peaks_Plots/', i, '.pdf' )
ggsave(
combine_plots_out,
combine_plots,
device = 'pdf',
width = 10,
height = 5,
units = 'in',
dpi = 300
)
}
for (i in random_samples) {
dat_temp <- dat %>%
select('Mass', i)%>%
filter(get(i) == 1)
mol_temp <- mol %>%
filter(!is.na(lamO2))
combine <- dat_temp %>%
left_join(mol_temp)%>%
filter(!is.na(delGd) & !is.na(lamO2) & !is.na(delGcoxPerCmol))
combine_filter <- combine %>%
select("delGd","lamO2","delGcoxPerCmol") %>%
add_column(Sample_Name = i, .before = 'delGd')
all_sample_peaks <- all_sample_peaks %>%
add_row(combine_filter)
Comp_mol_lm <- summary(lm(combine$lamO2 ~ combine$delGd))
Comp_mol_R2 <- Comp_mol_lm$r.squared # R2 for Gibbs per Comp mol (pH 7)
Comp_mol_slope <- Comp_mol_lm$coefficients[2,1] # slope for Gibbs per Comp mol (pH 7)
Comp_mol_eq <- glue('y = {round(Comp_mol_lm$coefficients[2],3)}x + {round(Comp_mol_lm$coefficients[1], 3)}')
C_mol_lm <- summary(lm(combine$lamO2 ~ combine$delGcoxPerCmol))
C_mol_R2 <- C_mol_lm$r.squared # R2 for Gibbs per C mol (pH 7)
C_mol_slope <- C_mol_lm$coefficients[2,1] # slope for Gibbs per C mol (pH 7)
C_mol_eq <- glue('y = {round(C_mol_lm$coefficients[2],3)}x + {round(C_mol_lm$coefficients[1], 3)}')
sample_stats <- tibble(
Sample_Name = i,
Number_of_Formulas = nrow(combine),
Comp_mol_lambda_R2 = Comp_mol_R2,
C_mol_lambda_R2 = C_mol_R2,
Comp_mol_lambda_slope = Comp_mol_slope,
C_mol_lambda_slope = C_mol_slope,
Comp_mol_lambda_eq = Comp_mol_eq,
C_mol_lambda_eq = C_mol_eq,
Comp_mol_C_mol_Rsq_Ratio = (Comp_mol_R2/C_mol_R2),
Comp_mol_C_mol_Slope_Ratio = (Comp_mol_slope/C_mol_slope)
)
sample_stats_combine <- sample_stats_combine %>%
add_row(sample_stats)%>%
arrange(Sample_Name)
# ================================  plot =======================================
# colors <- c("#2A788EFF", "#7AD151FF")
c_mol <- ggplot(data = combine_filter, aes(x = delGcoxPerCmol, y = lamO2, color = "#2A788EFF")) +
geom_point(size = .75)+
geom_smooth(method=lm, size = .75, color = 'black')+
labs(x = 'Gibbs (C-mol) ', y = 'Lambda')+
scale_color_manual(values = "#2A788EFF")
c_mol <- ggdraw(c_mol) +
draw_label(bquote(R^2 == . (round(sample_stats$C_mol_lambda_R2, 2))), x = 0.3, y = 0.9, fontfamily = 'serif')+
draw_label(sample_stats$C_mol_lambda_eq, x = 0.3, y = 0.85, fontfamily = 'serif')
c_mol
comp_mol<- ggplot(data = combine_filter, aes(x = delGd, y = lamO2, color = "#2A788EFF")) +
geom_point(size = .75)+
geom_smooth(method=lm, size = .75, color = 'black')+
labs(x = 'Gibbs (Comp-mol) ', y = 'Lambda')+
# annotate('text', x = quantile(combine_filter$delGd, probs = 0.95, na.rm = T), y = quantile(combine_filter$lamO2, probs = 0.95, na.rm = T), label = paste('R^2 ==',round(sample_stats$Comp_mol_lambda_R2, 2)), parse = T, size = 4, family = 'serif')+
# annotate('text', x = quantile(combine_filter$delGd, probs = 0.95, na.rm = T), y = quantile(combine_filter$lamO2, probs = 0.95, na.rm = T), label = sample_stats$Comp_mol_lambda_eq, size = 4, family = 'serif')+
scale_color_manual(values = "#2A788EFF")
comp_mol <- ggdraw(comp_mol) +
draw_label(bquote(R^2 == . (round(sample_stats$Comp_mol_lambda_R2, 2))), x = 0.3, y = 0.9, fontfamily = 'serif')+
draw_label(sample_stats$Comp_mol_lambda_eq, x = 0.3, y = 0.85, fontfamily = 'serif')
comp_mol
combine_plots <- ggarrange(
c_mol,
comp_mol,
ncol = 2,
nrow = 1,
widths = c(4),
heights = c(4, 4)
)
combine_plots <-
annotate_figure(combine_plots, top = text_grob(
i,
size = 14,
family = 'serif',
face = 'bold'
))
combine_plots_out <- paste0(here::here(),'/ECA_Within_Sample_Peaks_Plots/', i, '.pdf' )
ggsave(
combine_plots_out,
combine_plots,
device = 'pdf',
width = 10,
height = 5,
units = 'in',
dpi = 300
)
}
for (i in random_samples) {
dat_temp <- dat %>%
select('Mass', i)%>%
filter(get(i) == 1)
mol_temp <- mol %>%
filter(!is.na(lamO2))
combine <- dat_temp %>%
left_join(mol_temp)%>%
filter(!is.na(delGd) & !is.na(lamO2) & !is.na(delGcoxPerCmol))
combine_filter <- combine %>%
select("delGd","lamO2","delGcoxPerCmol") %>%
add_column(Sample_Name = i, .before = 'delGd')
all_sample_peaks <- all_sample_peaks %>%
add_row(combine_filter)
Comp_mol_lm <- summary(lm(combine$lamO2 ~ combine$delGd))
Comp_mol_R2 <- Comp_mol_lm$r.squared # R2 for Gibbs per Comp mol (pH 7)
Comp_mol_slope <- Comp_mol_lm$coefficients[2,1] # slope for Gibbs per Comp mol (pH 7)
Comp_mol_eq <- glue('y = {round(Comp_mol_lm$coefficients[2],3)}x + {round(Comp_mol_lm$coefficients[1], 3)}')
C_mol_lm <- summary(lm(combine$lamO2 ~ combine$delGcoxPerCmol))
C_mol_R2 <- C_mol_lm$r.squared # R2 for Gibbs per C mol (pH 7)
C_mol_slope <- C_mol_lm$coefficients[2,1] # slope for Gibbs per C mol (pH 7)
C_mol_eq <- glue('y = {round(C_mol_lm$coefficients[2],3)}x + {round(C_mol_lm$coefficients[1], 3)}')
sample_stats <- tibble(
Sample_Name = i,
Number_of_Formulas = nrow(combine),
Comp_mol_lambda_R2 = Comp_mol_R2,
C_mol_lambda_R2 = C_mol_R2,
Comp_mol_lambda_slope = Comp_mol_slope,
C_mol_lambda_slope = C_mol_slope,
Comp_mol_lambda_eq = Comp_mol_eq,
C_mol_lambda_eq = C_mol_eq,
Comp_mol_C_mol_Rsq_Ratio = (Comp_mol_R2/C_mol_R2),
Comp_mol_C_mol_Slope_Ratio = (Comp_mol_slope/C_mol_slope)
)
sample_stats_combine <- sample_stats_combine %>%
add_row(sample_stats)%>%
arrange(Sample_Name)
# ================================  plot =======================================
# colors <- c("#2A788EFF", "#7AD151FF")
c_mol <- ggplot(data = combine_filter, aes(x = delGcoxPerCmol, y = lamO2, color = "#2A788EFF")) +
geom_point(size = .75)+
geom_smooth(method=lm, size = .75, color = 'black')+
labs(x = 'Gibbs (C-mol) ', y = 'Lambda')+
scale_color_manual(values = "#2A788EFF")
c_mol <- ggdraw(c_mol) +
draw_label(bquote(R^2 == . (round(sample_stats$C_mol_lambda_R2, 2))), x = 0.3, y = 0.9, fontfamily = 'serif')+
draw_label(sample_stats$C_mol_lambda_eq, x = 0.35, y = 0.85, fontfamily = 'serif')
c_mol
comp_mol<- ggplot(data = combine_filter, aes(x = delGd, y = lamO2, color = "#2A788EFF")) +
geom_point(size = .75)+
geom_smooth(method=lm, size = .75, color = 'black')+
labs(x = 'Gibbs (Comp-mol) ', y = 'Lambda')+
# annotate('text', x = quantile(combine_filter$delGd, probs = 0.95, na.rm = T), y = quantile(combine_filter$lamO2, probs = 0.95, na.rm = T), label = paste('R^2 ==',round(sample_stats$Comp_mol_lambda_R2, 2)), parse = T, size = 4, family = 'serif')+
# annotate('text', x = quantile(combine_filter$delGd, probs = 0.95, na.rm = T), y = quantile(combine_filter$lamO2, probs = 0.95, na.rm = T), label = sample_stats$Comp_mol_lambda_eq, size = 4, family = 'serif')+
scale_color_manual(values = "#2A788EFF")
comp_mol <- ggdraw(comp_mol) +
draw_label(bquote(R^2 == . (round(sample_stats$Comp_mol_lambda_R2, 2))), x = 0.3, y = 0.9, fontfamily = 'serif')+
draw_label(sample_stats$Comp_mol_lambda_eq, x = 0.35, y = 0.85, fontfamily = 'serif')
comp_mol
combine_plots <- ggarrange(
c_mol,
comp_mol,
ncol = 2,
nrow = 1,
widths = c(4),
heights = c(4, 4)
)
combine_plots <-
annotate_figure(combine_plots, top = text_grob(
i,
size = 14,
family = 'serif',
face = 'bold'
))
combine_plots_out <- paste0(here::here(),'/ECA_Within_Sample_Peaks_Plots/', i, '.pdf' )
ggsave(
combine_plots_out,
combine_plots,
device = 'pdf',
width = 10,
height = 5,
units = 'in',
dpi = 300
)
}
